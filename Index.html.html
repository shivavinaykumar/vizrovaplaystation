<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VizrovaPlayStation — Tic Tac Toe (Mini)</title>
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--accent:#7dd3fc;--muted:#94a3b8;color-scheme:dark}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#031027 0%,#071330 100%);color:#e6eef8;margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .container{width:980px;max-width:100%;background:rgba(255,255,255,0.03);border-radius:12px;padding:18px;box-shadow:0 10px 30px rgba(2,6,23,0.6)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    h1{font-size:20px;margin:0}
    .controls{display:flex;gap:8px;align-items:center}
    input,button,select{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
    .board{display:grid;grid-template-columns:repeat(3,120px);gap:8px;justify-content:center;padding:12px}
    .cell{width:120px;height:120px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);display:flex;align-items:center;justify-content:center;font-size:48px;border-radius:8px;cursor:pointer;user-select:none}
    .small{font-size:13px;color:var(--muted)}
    .stats{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    .card{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;min-width:150px}
    footer{margin-top:12px;text-align:center;color:var(--muted)}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>VizrovaPlayStation — Tic Tac Toe (Mini)</h1>
      <div class="controls">
        <input id="username" placeholder="Create account (e.g. Kumar Merugu)" />
        <button id="btnLogin">Use account</button>
        <button id="btnReset">Reset Data</button>
      </div>
    </header>

    <div class="small">Welcome: <span id="welcome">first user</span> · Mode: <select id="mode"><option value="pvp">Play vs Human</option><option value="pvc">Play vs Computer (Easy)</option></select></div>

    <section style="display:flex;gap:18px;align-items:flex-start;margin-top:12px;flex-wrap:wrap">
      <div>
        <div class="board" id="board"></div>
        <div style="display:flex;gap:8px;justify-content:center;margin-top:8px">
          <button id="btnNew">New Game</button>
          <button id="btnAuto">Auto Fill (demo)</button>
        </div>
      </div>

      <aside style="flex:1;min-width:240px">
        <div class="card">
          <strong>Daily Challenge</strong>
          <div class="small">Play one game today to complete.</div>
          <div style="margin-top:8px"><button id="btnComplete">Mark win (for challenge)</button></div>
          <hr />
          <div><strong>Stats</strong></div>
          <div class="small">Wins today: <span id="winsToday">0</span></div>
          <div class="small">Total wins: <span id="winsTotal">0</span></div>
          <div class="small">Plays today: <span id="playsToday">0</span></div>
        </div>

        <div class="card" style="margin-top:12px">
          <strong>Challenges</strong>
          <div class="small">Daily / Weekly / Monthly progress is tracked locally in your browser.</div>
          <ul id="challengeList" class="small"></ul>
        </div>
      </aside>
    </section>

    <div class="stats" id="miniLeaderboard"></div>

    <footer>Mini version — local-only prototype. When you are ready we can deploy to GitHub Pages or Netlify.</footer>
  </div>

<script>
// --- Simple Tic Tac Toe + local account + daily/weekly/monthly tracking ---
const boardEl = document.getElementById('board');
const usernameInput = document.getElementById('username');
const btnLogin = document.getElementById('btnLogin');
const welcome = document.getElementById('welcome');
const modeSelect = document.getElementById('mode');
const btnNew = document.getElementById('btnNew');
const btnAuto = document.getElementById('btnAuto');
const btnComplete = document.getElementById('btnComplete');
const winsTodayEl = document.getElementById('winsToday');
const winsTotalEl = document.getElementById('winsTotal');
const playsTodayEl = document.getElementById('playsToday');
const challengeList = document.getElementById('challengeList');

let state = {cells:Array(9).fill(''), turn:'X', over:false};

function renderBoard(){
  boardEl.innerHTML='';
  state.cells.forEach((v,i)=>{
    const d = document.createElement('div'); d.className='cell'; d.textContent=v;
    d.onclick = ()=>cellClick(i);
    boardEl.appendChild(d);
  });
}

function cellClick(i){
  if(state.over || state.cells[i]) return;
  state.cells[i]=state.turn;
  state.turn = state.turn==='X'?'O':'X';
  playsInc();
  const winner = checkWinner();
  if(winner){ state.over=true; if(winner!=='draw') winInc(winner); alert('Result: '+winner); }
  renderBoard();
  if(modeSelect.value==='pvc' && !state.over){ aiMove(); }
}

function aiMove(){
  // super simple random move
  const free = state.cells.map((v,i)=>v?null:i).filter(x=>x!==null);
  if(!free.length) return;
  const pick = free[Math.floor(Math.random()*free.length)];
  state.cells[pick] = 'O';
  state.turn='X';
  const winner = checkWinner();
  if(winner){ state.over=true; if(winner!=='draw') winInc(winner); alert('Result: '+winner); }
  renderBoard();
}

function checkWinner(){
  const lines = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for(const [a,b,c] of lines){ if(state.cells[a] && state.cells[a]===state.cells[b] && state.cells[b]===state.cells[c]) return state.cells[a]; }
  return state.cells.every(x=>x)?'draw':null;
}

function newGame(){ state.cells = Array(9).fill(''); state.turn='X'; state.over=false; renderBoard(); }

// --- local storage data model ---
function getStorage(){
  const raw = localStorage.getItem('vizrova_playstation_v1');
  return raw?JSON.parse(raw):{users:{}}
}
function saveStorage(d){ localStorage.setItem('vizrova_playstation_v1',JSON.stringify(d)); }

function ensureUser(name){
  const store = getStorage();
  if(!store.users[name]){
    store.users[name]={winsTotal:0,winsByDate:{},playsByDate:{}};
    saveStorage(store);
  }
}

function setActiveUser(name){ localStorage.setItem('vizrova_active',name); ensureUser(name); refreshUI(); }

btnLogin.onclick = ()=>{ const n = usernameInput.value.trim()||'Kumar Merugu'; setActiveUser(n); }

function getActiveUser(){ return localStorage.getItem('vizrova_active') || 'first user'; }

function refreshUI(){
  const name = getActiveUser(); welcome.textContent = name; ensureUser(name);
  const store = getStorage(); const u = store.users[name];
  winsTotalEl.textContent = u.winsTotal||0;
  playsTodayEl.textContent = (u.playsByDate && u.playsByDate[todayKey()])||0;
  winsTodayEl.textContent = (u.winsByDate && u.winsByDate[todayKey()])||0;
  renderChallenges(); renderMiniLeaderboard();
}

function todayKey(){ const d=new Date(); return d.toISOString().slice(0,10); }

function winInc(winner){
  const store = getStorage(); const name = getActiveUser(); const u = store.users[name];
  u.winsTotal = (u.winsTotal||0)+1;
  const k = todayKey(); u.winsByDate[k] = (u.winsByDate[k]||0)+1;
  saveStorage(store); refreshUI();
}
function playsInc(){ const store=getStorage(); const name=getActiveUser(); const u=store.users[name]; const k=todayKey(); u.playsByDate[k]=(u.playsByDate[k]||0)+1; saveStorage(store); refreshUI(); }

btnNew.onclick = ()=>newGame(); btnAuto.onclick = ()=>{ // fill random to demo
  const free = state.cells.map((v,i)=>v?null:i).filter(x=>x!==null); if(!free.length) return; state.cells[free[0]]='X'; renderBoard(); }

btnComplete.onclick = ()=>{ alert('Marked a win for today'); winInc('X'); }

function renderChallenges(){
  const name=getActiveUser(); const store=getStorage(); const u=store.users[name];
  const today = todayKey();
  const dailyDone = (u.winsByDate && u.winsByDate[today])>0;
  const weekly = getRangeCount(u,'week'); const monthly = getRangeCount(u,'month');
  challengeList.innerHTML = '';
  const li1 = document.createElement('li'); li1.textContent = `Daily (1 game): ${dailyDone? '✔️ Done':'❌ Not yet'}`; challengeList.appendChild(li1);
  const li2 = document.createElement('li'); li2.textContent = `Weekly (5 wins target): ${weekly} wins` ; challengeList.appendChild(li2);
  const li3 = document.createElement('li'); li3.textContent = `Monthly (20 wins target): ${monthly} wins`; challengeList.appendChild(li3);
}

function getRangeCount(u,type){
  const now=new Date(); const store=getStorage();
  if(!u.winsByDate) return 0;
  const keys = Object.keys(u.winsByDate);
  let start;
  if(type==='week'){ const d=new Date(now); const day=d.getDay(); d.setDate(d.getDate()-day); start=d; }
  if(type==='month'){ start=new Date(now.getFullYear(), now.getMonth(), 1); }
  let sum=0; for(const k of keys){ const dt=new Date(k); if(dt>=start) sum+=u.winsByDate[k]; }
  return sum;
}

function renderMiniLeaderboard(){ const store=getStorage(); const users = Object.entries(store.users||{}).sort((a,b)=> (b[1].winsTotal||0)-(a[1].winsTotal||0)); const lb = document.getElementById('miniLeaderboard'); lb.innerHTML=''; users.slice(0,5).forEach(([name,data],i)=>{ const c=document.createElement('div'); c.className='card'; c.innerHTML=`<strong>#${i+1} ${name}</strong><div class="small">Wins: ${data.winsTotal||0}</div>`; lb.appendChild(c); }); }

// Reset data (careful)
const btnResetEl = document.getElementById('btnReset'); btnResetEl.onclick = ()=>{ if(confirm('Reset all local game data?')){ localStorage.removeItem('vizrova_playstation_v1'); localStorage.removeItem('vizrova_active'); location.reload(); }}

// init
newGame(); refreshUI();
</script>
</body>
</html>
